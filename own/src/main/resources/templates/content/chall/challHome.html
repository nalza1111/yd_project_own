<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" lang="ko">

<head>
<!-- jquery -->
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
<meta content="width=device-width, initial-scale=1.0" name="viewport" />
<meta content="Free HTML Templates" name="keywords" />
<!-- Favicon -->
<link href="/css/chall/img/favicon.ico" rel="icon" />
<!-- Google Web Fonts -->
<link rel="preconnect" href="https://fonts.gstatic.com" />
<link
	href="https://fonts.googleapis.com/css2?family=Handlee&family=Nunito&display=swap"
	rel="stylesheet" />
<!-- Font Awesome -->
<link
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
	rel="stylesheet" />
<!-- Flaticon Font -->
<link href="/css/chall/lib/flaticon/font/flaticon.css" rel="stylesheet" />
<!-- Libraries Stylesheet -->
<link href="/css/chall/lib/owlcarousel/assets/owl.carousel.min.css"
	rel="stylesheet" />
<link href="/css/chall/lib/lightbox/css/lightbox.min.css"
	rel="stylesheet" />
<!-- Customized Bootstrap Stylesheet -->
<link href="/css/chall/css/style.css" rel="stylesheet" />
<!-- JavaScript Libraries -->
<script
	src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
<script src="/css/chall/lib/easing/easing.min.js"></script>
<script src="/css/chall/lib/owlcarousel/owl.carousel.min.js"></script>
<script src="/css/chall/lib/isotope/isotope.pkgd.min.js"></script>
<script src="/css/chall/lib/lightbox/js/lightbox.min.js"></script>
<!-- Contact Javascript File -->
<script src="/css/chall/mail/jqBootstrapValidation.min.js"></script>
<script src="/css/chall/mail/contact.js"></script>
<!-- Template Javascript -->
<script src="/css/chall/js/main.js"></script>
<meta charset="utf-8">
<title>OWN _ 도전</title>
</head>
<body>
	<!-- 공통헤더 -->
	<!-- Navbar Start -->
	<div class="container-fluid bg-light position-relative shadow">
		<nav
			class="navbar navbar-expand-lg bg-light navbar-light py-3 py-lg-0 px-0 px-lg-5">
			<a href="" class="navbar-brand font-weight-bold text-secondary"
				style="font-size: 50px"> <i class="flaticon-043-teddy-bear"></i>
				<span class="text-primary">OWN_Challenges</span>
			</a>
			<button type="button" class="navbar-toggler" data-toggle="collapse"
				data-target="#navbarCollapse">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse justify-content-between"
				id="navbarCollapse">
				<div class="navbar-nav font-weight-bold mx-auto py-0">
					<a href="index.html" class="nav-item nav-link">Home</a> <a
						href="about.html" class="nav-item nav-link">About</a> <a
						href="class.html" class="nav-item nav-link">Classes</a> <a
						href="team.html" class="nav-item nav-link">Teachers</a> <a
						href="gallery.html" class="nav-item nav-link">Gallery</a>
					<div class="nav-item dropdown">
						<a href="#" class="nav-link dropdown-toggle"
							data-toggle="dropdown">Pages</a>
						<div class="dropdown-menu rounded-0 m-0">
							<a href="blog.html" class="dropdown-item">Blog Grid</a> <a
								href="single.html" class="dropdown-item">Blog Detail</a>
						</div>
					</div>
					<a href="contact.html" class="nav-item nav-link active">Contact</a>
				</div>
				<a href="" class="btn btn-primary px-4">Join Class</a>
			</div>
		</nav>
	</div>
	<!-- Navbar End -->

	<!-- Header Start -->
	<div class="container-fluid bg-primary mb-5">
		<div
			class="d-flex flex-column align-items-center justify-content-center"
			style="min-height: 400px">
			<h3 class="display-3 font-weight-bold text-white">Contact Us</h3>
			<div class="d-inline-flex text-white">
				<p class="m-0">
					<a class="text-white" href="">Home</a>
				</p>
				<p class="m-0 px-2">/</p>
				<p class="m-0">Contact Us</p>
			</div>
		</div>
	</div>
	<!-- Header End -->

	<div th:if="${session.loginUser}">
		도전 홈 _ 로그인 중
		<h1 th:text="${session.loginUser.userId}"></h1>
		<input id="userId" type="hidden"
			th:value="${session.loginUser.userId}">
	</div>
	<div th:if="${session.loginUser} == null">로그인 안한 상태 로그인 하고 오시오.</div>
	<button type="button" id="addChallBtn">도전등록으로 이동</button>
	<a href="/own/chall/mypage">마이페이지</a>
	<a href="/own/chall/insertFormChall">내가 참여중인 도전보기</a>
	<a href="/own/chall/insertFormChall">내가 만든 도전보기</a>
	<h3>오운 홈</h3>

	<!-- 운동카테고리 -->
	<!-- Facilities Start -->
	<div class="container-fluid pt-5">
		<div class="container pb-3">
			<div class="row">
				<div class="col-lg-2 col-md-3 pb-1" style="text-align: center;">
					<i class="flaticon-022-drum h1 font-weight-normal text-primary mb-3"></i>
					<p>수영</p>
				</div>
				<div class="col-lg-2 col-md-3 pb-1" style="text-align: center;">
					<i class="fa fa-swimmer "></i>
					<p>수영</p>
				</div>
				<div class="col-lg-2 col-md-3 pb-1" style="text-align: center;">
					<i class="fa fa-baseball-ball"></i>
					<p>수영</p>
				</div>
				<div class="col-lg-2 col-md-3 pb-1" style="text-align: center;">
					<i class="flaticon-022-drum h1 font-weight-normal text-primary mb-3"></i>
					<p>수영</p>
				</div>
				<div class="col-lg-2 col-md-3 pb-1" style="text-align: center;">
					<i class="flaticon-022-drum h1 font-weight-normal text-primary mb-3"></i>
					<p>수영</p>
				</div>
				<div class="col-lg-2 col-md-3 pb-1" style="text-align: center;">
					<i class="flaticon-022-drum h1 font-weight-normal text-primary mb-3"></i>
					<p>수영</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Facilities Start -->

	<!-- 운동카테고리 끝 -->

	<!-- 나의 도전 -->
	<div class="container-fluid pt-5">
		<div class="container">
			<div class="text-center pb-2">
				<p class="section-title px-5">
					<span class="px-2">My Page</span>
				</p>
				<h1 class="mb-4">나의 도전</h1>
			</div>
			<!-- 여기부터  6개 한블럭? -->
			<div class="row pb-3">
				<th:block th:each="my: ${myChall}">
					<div class="col-lg-4 mb-4">
						<div class="card border-0 shadow-sm mb-2">
							<img class="card-img-top mb-2"
								th:src="|/imgView/${my.firstImage}|" alt=""
								style="height: 230px; object-fit: cover" />
							<div class="card-body bg-light text-center p-4">
								<input type="hidden" th:value="${my.challNo}" />
								<h4 class="" th:text="${my.challTitle}"></h4>
								<div class="d-flex justify-content-center mb-3">
									<small class="mr-3">[[${#dates.format(my.challStartdate,
										'M/d')}]]시작</small> <small class="mr-3">[[${my.challDuration}]]주
										동안</small> <small class="mr-3">주 [[${my.challFreq}]]회</small>
								</div>
								<a
									th:href="@{/own/chall/detailChall(challNo = ${#strings.substringAfter(my.challNo, 'CHA_')})}"
									class="btn btn-primary px-4 mx-auto my-2">상세보기</a>
							</div>
						</div>
					</div>
				</th:block>
			</div>
		</div>
		<!-- 도전 6개 끝 -->

		<!-- 페이징 -->
		<!-- 페이징 -->


	</div>

	<!-- 나의도전 끝 -->

	<!-- 새로운 도전 -->
	<div class="container-fluid pt-5">
		<div class="container">
			<div class="text-center pb-2">
				<p class="section-title px-5">
					<span class="px-2">New challenge</span>
				</p>
				<h1 class="mb-4">새로운 도전</h1>
			</div>
			<div class="row pb-3" id="challRow">
				<th:block th:each="cha: ${popChall}">
					<div class="col-lg-4 mb-5">
						<div class="card border-0 bg-light shadow-sm pb-2">
							<input type="hidden" th:value="${cha.challNo}" /> <img
								class="card-img-top mb-2" th:src="|/imgView/${cha.firstImage}|"
								alt="" />
							<div class="card-body text-center">
								<h4 class="card-title" th:text="${cha.challTitle}"></h4>
								<p class="card-text">간단소개?</p>
							</div>
							<div class="card-footer bg-transparent py-4 px-5">
								<div class="row border-bottom">
									<div class="col-6 py-1 text-right border-right">
										<strong>CATEGORY</strong>
									</div>
									<div class="col-6 py-1" th:text="${cha.challCategory}"></div>
								</div>
								<div class="row border-bottom">
									<div class="col-6 py-1 text-right border-right">
										<strong>START DATE</strong>
									</div>
									<div class="col-6 py-1"
										th:text="${#dates.format(cha.challStartdate, 'MM월 dd일')}"></div>
								</div>
								<div class="row border-bottom">
									<div class="col-6 py-1 text-right border-right">
										<strong>도전 횟수</strong>
									</div>
									<div class="col-6 py-1" th:text="${cha.challFreq}"></div>
								</div>
								<div class="row border-bottom">
									<div class="col-6 py-1 text-right border-right">
										<strong>도전 금액</strong>
									</div>
									<div class="col-6 py-1" th:text="${cha.challPrice}"></div>
								</div>
								<div class="row border-bottom">
									<div class="col-6 py-1 text-right border-right">
										<strong>현재 도전 회원</strong>
									</div>
									<div class="col-6 py-1" th:text="${cha.nowMember}"></div>
								</div>
								<div class="row">
									<div class="col-6 py-1 text-right border-right">
										<strong>도전 기간</strong>
									</div>
									<div class="col-6 py-1" th:text="${cha.challDuration}"></div>
								</div>
							</div>
							<a
								th:href="@{/own/chall/detailChall(challNo = ${#strings.substringAfter(cha.challNo, 'CHA_')})}"
								class="btn btn-primary px-4 mx-auto mb-4">상세보기</a>
						</div>
					</div>
				</th:block>
			</div>
		</div>

		<!-- 페이징버튼 넣기 -->
		<nav class="blog-pagination justify-content-center d-flex"
			id="pagegation">
			<!--================ 이전  =================-->
			<ul class="pagination">
				<li class="page-item" th:if="${paging.startPage>1}"><a
					class="page-link" aria-label="Previous"
					th:value="${paging.startPage-1}"> <span aria-hidden="true"><span
							class="lnr lnr-chevron-left pagePort"></span></span></a></li>
				<!--================ 페이지 이동 1_2_3_4_5  =================-->
				<th:block
					th:each="pag:${#numbers.sequence(paging.startPage,paging.endPage)}">
					<li class="page-item" th:if="${pag != paging.page}"><a
						class="page-link pagePort" th:value="${pag}"
						th:text="${#numbers.formatInteger(pag,2)}"></a></li>
					<li class="page-item active" th:if="${pag==paging.page}"><a
						class="page-link" th:text="${#numbers.formatInteger(pag,2)}"></a>
					</li>
				</th:block>
				<!--================ 페이지 이동 1_2_3_4_5 끝 =================-->
				<!--================ 이후  =================-->
				<li class="page-item" th:if="${paging.endPage<paging.lastPage}">
					<a class="page-link pagePort" aria-label="Next"
					th:value="${paging.endPage+1}"> <span aria-hidden="true"><span
							class="lnr lnr-chevron-right"></span></span></a>
				</li>
			</ul>
		</nav>
		<!-- 페이징버튼 끝 -->
	</div>
	<!-- 새로운 도전 끝 -->

	<!-- 인기 도전 -->
	<!-- 인기도전 끝 -->

	<!-- Footer Start -->
	<div
		class="container-fluid bg-secondary text-white mt-5 py-5 px-sm-3 px-md-5">
		<div class="row pt-5">
			<div class="col-lg-3 col-md-6 mb-5">
				<a href=""
					class="navbar-brand font-weight-bold text-primary m-0 mb-4 p-0"
					style="font-size: 40px; line-height: 40px"> <i
					class="flaticon-043-teddy-bear"></i> <span class="text-white">KidKinder</span>
				</a>
				<p>Labore dolor amet ipsum ea, erat sit ipsum duo eos. Volup
					amet ea dolor et magna dolor, elitr rebum duo est sed diam elitr.
					Stet elitr stet diam duo eos rebum ipsum diam ipsum elitr.</p>
				<div class="d-flex justify-content-start mt-4">
					<a
						class="btn btn-outline-primary rounded-circle text-center mr-2 px-0"
						style="width: 38px; height: 38px" href="#"><i
						class="fab fa-twitter"></i></a> <a
						class="btn btn-outline-primary rounded-circle text-center mr-2 px-0"
						style="width: 38px; height: 38px" href="#"><i
						class="fab fa-facebook-f"></i></a> <a
						class="btn btn-outline-primary rounded-circle text-center mr-2 px-0"
						style="width: 38px; height: 38px" href="#"><i
						class="fab fa-linkedin-in"></i></a> <a
						class="btn btn-outline-primary rounded-circle text-center mr-2 px-0"
						style="width: 38px; height: 38px" href="#"><i
						class="fab fa-instagram"></i></a>
				</div>
			</div>
			<div class="col-lg-3 col-md-6 mb-5">
				<h3 class="text-primary mb-4">Get In Touch</h3>
				<div class="d-flex">
					<h4 class="fa fa-map-marker-alt text-primary"></h4>
					<div class="pl-3">
						<h5 class="text-white">Address</h5>
						<p>123 Street, New York, USA</p>
					</div>
				</div>
				<div class="d-flex">
					<h4 class="fa fa-envelope text-primary"></h4>
					<div class="pl-3">
						<h5 class="text-white">Email</h5>
						<p>info@example.com</p>
					</div>
				</div>
				<div class="d-flex">
					<h4 class="fa fa-phone-alt text-primary"></h4>
					<div class="pl-3">
						<h5 class="text-white">Phone</h5>
						<p>+012 345 67890</p>
					</div>
				</div>
			</div>
			<div class="col-lg-3 col-md-6 mb-5">
				<h3 class="text-primary mb-4">Quick Links</h3>
				<div class="d-flex flex-column justify-content-start">
					<a class="text-white mb-2" href="#"><i
						class="fa fa-angle-right mr-2"></i>Home</a> <a class="text-white mb-2"
						href="#"><i class="fa fa-angle-right mr-2"></i>About Us</a> <a
						class="text-white mb-2" href="#"><i
						class="fa fa-angle-right mr-2"></i>Our Classes</a> <a
						class="text-white mb-2" href="#"><i
						class="fa fa-angle-right mr-2"></i>Our Teachers</a> <a
						class="text-white mb-2" href="#"><i
						class="fa fa-angle-right mr-2"></i>Our Blog</a> <a class="text-white"
						href="#"><i class="fa fa-angle-right mr-2"></i>Contact Us</a>
				</div>
			</div>
			<div class="col-lg-3 col-md-6 mb-5">
				<h3 class="text-primary mb-4">Newsletter</h3>
				<form action="">
					<div class="form-group">
						<input type="text" class="form-control border-0 py-4"
							placeholder="Your Name" required="required" />
					</div>
					<div class="form-group">
						<input type="email" class="form-control border-0 py-4"
							placeholder="Your Email" required="required" />
					</div>
					<div>
						<button class="btn btn-primary btn-block border-0 py-3"
							type="submit">Submit Now</button>
					</div>
				</form>
			</div>
		</div>
		<div class="container-fluid pt-5"
			style="border-top: 1px solid rgba(23, 162, 184, 0.2);">
			<p class="m-0 text-center text-white">
				&copy; <a class="text-primary font-weight-bold" href="#">Your
					Site Name</a>. All Rights Reserved.

				<!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
				Designed by <a class="text-primary font-weight-bold"
					href="https://htmlcodex.com">HTML Codex</a> <br />Distributed By:
				<a href="https://themewagon.com" target="_blank">ThemeWagon</a>
			</p>
		</div>
	</div>
	<!-- Footer End -->

	<script>

		$('#pagegation').on('click', '.pagePort', function(){
		    //페이지번호 + 밴드식별번호
		    let page = $(this).attr('value');
		    console.log($(this).attr('value'));
		    $.ajax({
		       url: '/own/chall/popChallAjax?page='+page,
		       method: 'get',
		    }).then(result => {
		       console.log(result);
				//형태만들기
				let Chall = $('#ChallRow')
				$('#challRow').empty();
				result.forEach( cha => {
		          console.log(cha.challNo)
				  makeChallDiv(cha);
		        })
		
		       //페이지 버튼 만들기
		       $('#pagegation').empty();
		          let pagingM = result[0].paging;
		          //시작 버튼
		        console.log(result[0]);
		          let startpageTag = $('<ul class="pagination" />');
		          $('#pagegation').append(startpageTag);
		          //이전 버튼만들기
		          if(pagingM.startPage>1){
		             let pageBeforTag = `<li class="page-item">
		                            <a class="page-link" aria-label="Previous" value=${pagingM.startPage-1}>
		                            <span aria-hidden="true"><span class="lnr lnr-chevron-left pagePort"></span></span></a>
		                            </li>`
		                startpageTag.append(pageBeforTag);               
		          }               
		          //페이지목록..
		          for(let pg = pagingM.startPage; pg<=pagingM.endPage; pg++){
		             if(pg != pagingM.page){
		                let pageTag = `<li class="page-item">
		                            <a class="page-link pagePort" value=${pg}>${pg}</a>
		                            </li>`
		                startpageTag.append(pageTag);
		             } else if(pg == pagingM.page ){
						 let pageTag =  `<li class="page-item active">
							<a class="page-link" >${pg}</a>
							</li>`
							startpageTag.append(pageTag);
						}
					}               
					//이후 버튼만들기
					if(pagingM.endPage<pagingM.lastPage){
						let pageAfterTag =`<li class="page-item">
							<a class="page-link pagePort" aria-label="Next" value=${pagingM.endPage+1}>
								<span aria-hidden="true"><span class="lnr lnr-chevron-right"></span></span></a>
								</li>`
								startpageTag.append(pageAfterTag);
							}
							$('#pagegation').append(startpageTag)
						})
		       })
		
		//챌린지 폼 만들기
		function makeChallDiv(cha){
			console.log(cha.challLeader);
			let challNo = cha.challNo.substr(4);
			console.log(challNo);
			let div1 = $('<div />').addClass("col-lg-4 mb-4");
			let div2 = $('<div />').addClass("card border-0 shadow-sm mb-2");
			let hiddenInput = $('<input />').attr('type', 'hidden').val(cha.challNo);
			let img2_1 = $('<img />').addClass("card-img-top mb-2").attr('src', '/imgView/'+ cha.firstImage).attr('style', 'height:230px; object-fit: cover')
			let div2_2 = $('<div />').addClass("card-body bg-light text-center p-4")
			let h4_3 = $('<h4 />').addClass("card-title"). text(cha.challTitle);
			let div_3 = $('<div />').addClass("d-flex justify-content-center mb-3").append(($('<small />').addClass("mr-3").text(cha.nowMember + '참여중')),
																						   ($('<small />').addClass("mr-3").text(cha.challDuration + '주 동안')),
																						   ($('<small />').addClass("mr-3").text('주 '+cha.challFreq + '회'))
																						  );
			let a_3 = $('<a />').addClass("btn btn-primary px-4 mx-auto my-2").attr('href', 'detailChall?challNo=' + challNo).text('도전하러 가기'); 
			div1.append(div2.append(hiddenInput, img2_1, div2_2.append(h4_3, div_3, a_3)));
			$('#challRow').append(div1);
		}
			
</script>
</body>
</html>