<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/default_layout}">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<div layout:fragment="content">
	<body>
		<div>
			<table border="1px soild">
				<thead>
					<th>유저아이디</th>
					<th>밴드닉네임</th>
					<th>밴드번호</th>
					<th>band_member_status</th>
					<th>band_kick_status</th>
					<th>밴드가입날짜</th>
					<th>band_member_no</th>
					<th>band_birth</th>
					<th>band_gender</th>
					<th>채팅방 여부</th>
					<th>채팅하기</th>

				</thead>
				<tbody id="reportList">
					<tr th:each="list : ${memberList}" >
						<span
							th:if="${!#strings.equals(session.loginUser.userId, list.userId)}">
							<td th:text="${list.userId}"></td>
							<td th:text="${list.bandNickname}"></td>
							<td th:text="${list.bandNo}"></td>
							<td th:text="${list.bandMemberStatus}"></td>
							<td th:text="${list.bandKickStatus}"></td>
							<td th:text="${list.bandSignupDate}"></td>
							<td th:id="${list.bandMemberNo}" th:text="${list.bandMemberNo}"></td>
							<td th:text="${list.bandBirth}"></td>
							<td th:text="${list.bandGender}"></td>
							<td th:text="${list.chatCheck}"></td>
							<td><button class="oldChatStart"
									th:if="${list.chatCheck == 1}">기존채팅하기</button></td>
							<td><button class="newChatStart"
									th:if="${list.chatCheck == 0}">새로채팅하기</button></td>
						</span>
						
					</tr>
				</tbody>
			</table>
		</div>
		<script src="/webjars/sockjs-client/sockjs.min.js"></script>
		<script src="/webjars/stomp-websocket/stomp.min.js"></script>
		<script type="text/javascript">
			$(function() {
				$("#newChatStart").click(function() {
					createChatroom();
				});
			});

			function createChatroom() {
				//let bMemNo = ${"#bandMemberNo"}.val();
				var chatroomDataList = new Array();
				var chatroomData = {}; 
				let bMemNo1 = '';
				// 채팅방 새로 생성하기
				$.ajax({
					url : '/createChatroom',
					method : 'post',
					contentType : 'application/x-www-form-urlencoded',
					data : '데이터',
					beforeSend : function(xhr) {
						xhr.setRequestHeader(header, token);
					},
					success : function(result) {
						//방번호 가지고 이동
					},
					error : function(error) {
						console.log("error: " + error);
					}
				});

			}
		</script>
	</body>
</div>
</html>
