 <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
     

<head>
    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>-->
    <!-- SlidesJS Required: Link to jquery.slides.js -->

    <!-- End SlidesJS Required -->
        
    <!-- ========== Meta Tags ========== -->
    <meta charset="UTF-8">
    <meta name="description" content="Cocoon -Portfolio">
    <meta name="keywords" content="Cocoon , Portfolio">
    <meta name="author" content="Pharaohlab">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- ========== Title ========== -->
    <title> Cocoon -Portfolio</title>
    <!-- ========== Favicon Ico ========== -->
    <!--<link rel="icon" href="fav.ico">-->
    <!-- ========== STYLESHEETS ========== -->
    <!-- Bootstrap CSS -->
    <link href="/css/sns/css/bootstrap.min.css" rel="stylesheet">
    <!-- Fonts Icon CSS -->
    <link href="/css/sns/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/sns/css/et-line.css" rel="stylesheet">
    <link href="/css/sns/css/ionicons.min.css" rel="stylesheet">
    <!-- Carousel CSS -->
    <link href="/css/sns/css/slick.css" rel="stylesheet">
    <!-- Magnific-popup -->
    <link rel="stylesheet" href="/css/sns/css/magnific-popup.css">
    <!-- Animate CSS -->
    <link rel="stylesheet" href="/css/sns/css/animate.min.css">
    <!-- Custom styles for this template -->
    <link href="/css/sns/css/main.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet" />
    <style>
        .modal {
            display: none;
            /* Hidden by default */
            position: fixed;
            /* Stay in place */
            z-index: 21;
            /* Sit on top */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgb(0, 0, 0);
            /* Fallback color */
            background-color: rgba(0, 0, 0, 0.4);
            /* Black w/ opacity */
        }

        /* Modal Content/Box */
        .modal-content {
            background-color: #fefefe;
            margin: 0% auto;
            /* 15% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 28%;
            /* Could be more or less, depending on screen size */
            font-size: 13px;
        }

        /* The Close Button */
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            text-align: right;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        .modalBtn {
            font-size: 13px;
            color: black;
            cursor: pointer;
        }

        #att_zone {
            width: 530px;
            min-height: 440px;
            padding: 10px;
            border: 1px dotted lightblue;
        }

        #att_zone:empty:before {
            content: attr(data-placeholder);
            color: #999;
            font-size: .9em;
        }

        .followBtn {
            position: absolute;
            top: 5px;
            left: 529px;
            width: 70px;
            height: 30px;
            font-size: 13px;
            background-color: skyblue;
            border-color: white;
            color: white;
            font-weight: 700;
            cursor: pointer;
        }

        .profile {
            width: 700px;
            height: 200px;
            margin: 0 auto;
            position: relative;
        }

        .profile>p {
            position: absolute;
            top: 35px;
            left: 300px;
            font-size: 11px;
            color: blue;
            font-weight: 600;
        }

        #instaImg {
            width: 146px;
            height: 146px;
            border-radius: 50%;
            position: absolute;
            top: 1px;
            left: 61px;
        }

        .profileImg {
            position: absolute;
            top: 4px;
            left: 64px;
            border-radius: 50%;
            width: 140px;
            height: 140px;
            object-fit: cover;
            cursor: pointer;
        }

        .feedCount {
            font-size: 14px;
            font-weight: 600;
            padding-left: 5px;
        }

        #feedCount {
            position: absolute;
            top: 55px;
            left: 300px;
        }

        #profileContent {
            position: absolute;
            top: 90px;
            left: 300px;
            font-size: 13px;
            text-align: left;
        }

        .storyProfileImg {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            position: absolute;
            top: -5px;
            left: -10px;
        }

        .storyProfileName {
            font-size: 15px;
            position: absolute;
            top: 6px;
            left: 57px;
            font-weight: 600;
        }

        .storyImg {
            width: 600px;
            height: 518px;
            position: absolute;
            top: 0px;
            left: -20px;
            object-fit: cover;
            opacity: 0;
        }

        .storyImg.active{
            opacity: 1;
        }

        .storyProfileDate {
            position: absolute;
            top: 6px;
            right: 25px;
            font-size: 14px;
            opacity: 0;
        }

        .storyProfileDate.active{
            opacity: 1;
        }
        .snsStoryDel{
            position: absolute;
            font-size: 11px;
            color: lightblue;
            top: 60px;
            right: 4px;
            opacity: 0;
            z-index: 22;
        }
        
        .snsStoryDel.active{
            opacity: 1;

        }
        

        .Feedmodal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 21; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }
        /* Modal Content/Box */
        .Feedmodal-content {
            background-color: #fefefe;
            margin: 15% auto; /* 15% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 50%; /* Could be more or less, depending on screen size */
        }
        li.dot{
            background-color: lightgray;
            margin-top: 20px;
            margin-left: 10px;
        }
        li.dot:hover {
            background-color: lightblue;
        }
        li.dot.active {
            background-color: skyblue;
        }

        .boardImg{
            opacity: 0;
        }
        .boardImg.active{
            transform: translateX(0);
            opacity: 1;
            visibility: visible;
            z-index: 20;
        }
        .btnIcon{
            width: 60px;
            height: 39px;     
            margin-top: 20px;
        }
        #snsLikeBtn{
            width: 25px;
            height: 25px;
            cursor: pointer;
        }

        /*게시글 더보기*/
        .feed-content {
            display: inline-block;
            width: 230px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            vertical-align: top;
        }

        .feed-content.more {
            display: inline;
            white-space: normal;
        }
        .btn-more{
            color:lightgray;
            font-size: 12px;
            cursor: pointer;
        }

        #fileLabel{
            position: absolute;
            top: 252px;
            left: 212px;
            color: cornflowerblue;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
            padding-top: 3px;
            font-weight: 800;
        }
        .nicknameBox{
            position: absolute;
            top:280px;
            right: 5px;
            color: white;
        }

        #profileTextBox{
            position: absolute;
            top: 323px;
            right: 5px;
            width:480px; 
            height:100px;
            padding: 10px;
        }

        #websiteLink{
            position: absolute;
            top: 422px;
            right: 5px;
            width: 480px;
            padding:10px;
            border-radius: 0px;
            color: gray;
        }

        #updateLabel{
            position: absolute;
            top: 500px;
            right: 3px;
            background-color: #6ab0cd;
            border-radius: 20px;
            width: 100px;
            height: 30px;
            color: white;
            font-size: 15px;
            cursor: pointer;
            text-align: center;
            padding-top: 4px;
            font-weight: 600;
        }
        input[type=text]{
            border:2px solid #aaa;
            border-radius:4px;
            margin: 8px 0;
            outline: none;
            padding:8px;
            box-sizing: border-box;
            transition:.3s;
            width: 300px;
        }

        input[type=text]:focus{
            border-color:lightblue;
            box-shadow:0 0 8px 0 lightBlue;
        }
        
        textarea {
            border:2px solid #aaa;
            border-radius:4px;
            margin: 8px 0;
            outline: none;
            padding:8px;
            box-sizing: border-box;
            transition:.3s;
        }

        textarea:focus{
            border-color:lightblue;
            box-shadow:0 0 8px 0 lightblue;
        }

        .followDelbtn{
            background-color:#6ab0cd;
            color: white;
            border: none;
            border-radius: 15px;
            width: 50px;
            height: 30px;
            cursor: pointer;
            margin-left: 15px;
        }

        #schoolInput{
            width: 260px;
            height: 45px;
            border-radius: 20px;
            margin-top: 30px;
            margin-left: 20px;
            margin-bottom: 10px;
            background-color: ghostwhite;
            border:none;
            padding:20px;
        }

        .snsFeedWriteBtn{
            background-color:#6ab0cd;
            color: white;
            border: none;
            border-radius: 25px;
            width: 100px;
            height:40px;
            cursor: pointer;
            margin-left: 5px; 
            position: absolute; 
            bottom: 3%; 
            right: 3%;
            font-size: 15px;
            font-weight: 600;
        }

        .searchProfileImg{
            width:50px;
            height:50px;
            border-radius: 50%;
            margin: 10px;
        }

        .replyInput{
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color:gray;
        }
        #snsReplyCount{
            font-weight: 600;
        }
        #snsLikeCount{
            font-weight: 600;
        }
        .insertBtn{
	        width: 200px;
		    height: 40px;
		    margin-left: 60px;
		    margin-right: 10px;
		    background-color: #6ab0cd;
		    border: none;
		    color: white;
		    font-size: 16px;
		    border-radius: 25px;
		    cursor:pointer;
        }
        
        .delBtn{
	        width: 200px;
		    height: 40px;
		    background-color: white;
		    border: none;
		    color: #6ab0cd;
		    font-size: 16px;
		    border-radius: 25px;
		    border: 3px solid #6ab0cd;
		    cursor:pointer;
        }
        
        #schoolList{
            z-index: 1;
            position: absolute;
            margin-left: 20px;
            background-color: white;
            width: 265px;
            opacity: 0.9;
            font-weight: 600;
        }
        #btnreporting{
            width: 100px;
            height: 40px;
            margin-left: 47px;
            margin-right: 10px;
            background-color: #6ab0cd;
            border: none;
            color: white;
            font-size: 16px;
            border-radius: 25px;
            cursor: pointer;
        }

        #btnsignin{
            width: 100px;
            height: 40px;
            background-color: white;
            color: #6ab0cd;
            font-size: 16px;
            border-radius: 25px;
            border: 3px solid #6ab0cd;
            cursor: pointer;
        }
    </style><!--스타일-->
    
    <!-- jquery -->
    <script src="/css/sns/js/jquery.min.js"></script>
    <!-- bootstrap -->
    <script src="/css/sns/js/popper.js"></script>
    <script src="/css/sns/js/bootstrap.min.js"></script>
    <script src="/css/sns/js/waypoints.min.js"></script>
    <!--slick carousel -->
    <script src="/css/sns/js/slick.min.js"></script>
    <!--Portfolio Filter-->
    <script src="/css/sns/js/imgloaded.js"></script>
    <script src="/css/sns/js/isotope.js"></script>
    <!-- Magnific-popup -->
    <script src="/css/sns/js/jquery.magnific-popup.min.js"></script>
    <!--Counter-->
    <script src="/css/sns/js/jquery.counterup.min.js"></script>
    <!-- WOW JS -->
    <script src="/css/sns/js/wow.min.js"></script>
    <!-- Custom js -->
    <script src="/css/sns/js/main.js"></script>

</head>
<div layout:fragment="content">
<body>
    <div class="loader">
        <div class="loader-outter"></div>
        <div class="loader-inner"></div>
    </div>

    <div class="body-container container-fluid">
        <a class="menu-btn" href="javascript:void(0)">
            <i class="ion ion-grid"></i>
        </a>
        <div class="row justify-content-center">
            <!--=================== side menu ====================-->
            <div class="col-lg-2 col-md-3 col-12 menu_block">

                <!--logo -->
                <div class="logo_box">
                    <a href="/own/home"><span style="color: white; font-size:50px; font-weight: 600; font-family: Cafe24Ohsquare;">오늘의 운동</span></a>
                </div>
                <!--logo end-->

                <div id="schoolLi" style="position:relative">
                    <input type="text" id="schoolInput" placeholder="검색" onkeyup="search(this);">
                        <div id="schoolList" style="z-index:1; position: absolute; margin-left: 20px;"></div>
                </div>
                <!--main menu -->
                <div class="side_menu_section">
                    <ul class="menu_nav">
                        <li> <a href="/own/home">Home</a></li>
                        <li>
                            <a href="/own/sns">
                                sns메인
                            </a>
                        </li>
                        <li class="active" th:if="${userId.snsNickname == snsInfo.snsNickname}">
                            <a th:href="@{snsFeed(snsNickname=${userId.snsNickname})}">나의 피드</a>
                        </li>
                        <li th:if="${userId.snsNickname != snsInfo.snsNickname}">
                            <a th:href="@{snsFeed(snsNickname=${userId.snsNickname})}">나의 피드</a></li>
                   	    <li><a href="/own/snsNewFeed">최신게시글</a></li>

                    </ul>
                </div>
                <!--main menu end -->

                <!--social and copyright -->
                <div class="side_menu_bottom">
                    <div class="side_menu_bottom_inner">
                        <ul class="social_menu">
                            <li>
                                <a href="#"> <i class="ion ion-social-pinterest"></i> </a>
                            </li>
                            <li>
                                <a href="#"> <i class="ion ion-social-facebook"></i> </a>
                            </li>
                            <li>
                                <a href="#"> <i class="ion ion-social-twitter"></i> </a>
                            </li>
                            <li>
                                <a href="#"> <i class="ion ion-social-dribbble"></i> </a>
                            </li>
                        </ul>
                        <div class="copy_right">
                            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                            <p class="copyright">Copyright &copy;<script>
                                    document.write(new Date().getFullYear());
                                </script> All rights reserved | This template is made with <i class="fa fa-heart-o"
                                    aria-hidden="true"></i> by <a href="https://colorlib.com"
                                    target="_blank">Colorlib</a></p>
                            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        </div>
                    </div>
                </div>
                <!--social and copyright end -->

            </div>
            <!--=================== side menu end====================-->

            <!--=================== content body ====================-->
            <div class="col-lg-10 col-md-9 col-12 body_block  align-content-center">
                <!--=================== filter portfolio start====================-->
                <div id="snsprofilebox" >
                    <br>
                    <div class="profile">
                        <img id="instaImg" src="/css/sns/img/insta.png" th:if="${!#lists.isEmpty(snsStoryList)}">
                        <img th:if="${userId.snsNickname == snsInfo.snsNickname}" 
                             src="/css/sns/img/plusIcon2.png" class="modalBtn" style="position:absolute;top:111px; left:191px; width:30px; height:30px; z-index: 1; cursor:pointer">

                        <div th:if="${!#lists.isEmpty(snsStoryList)}">
                        <span class="modalBtn">
                            <img th:if="${profileImg == null}" class="profileImg" src="/css/sns/img/defaultUser.png">
                            <span th:unless="${profileImg == null}">
                            <img class="profileImg" th:src="|/imgView/${profileImg.mediaServerFile}" onerror='this.src="/css/sns/img/defaultUser.png"'></span>
                        </span>
                        </div>
                        <div th:unless="${!#lists.isEmpty(snsStoryList)}">
                        <span>
                            <img th:if="${profileImg == null}" class="profileImg" src="/css/sns/img/defaultUser.png">
                            <span th:unless="${profileImg == null}">
                            <img class="profileImg" th:src="|/imgView/${profileImg.mediaServerFile}" onerror='this.src="/css/sns/img/defaultUser.png"'></span>
                        </span>
                        </div>

                        <span id="snsNickname" th:text="${snsInfo.snsNickname}" th:value="${snsInfo.snsAccountNo}"
                            style="position: absolute; top:0px; left:300px; font-size:22px; font-weight: 600;"></span>

                        <p th:if="${userId.snsNickname == snsInfo.snsNickname}" class="modalBtn" style="cursor:pointer">프로필 변경</p>
                        <td th:if="${userId.snsNickname != snsInfo.snsNickname}">
                            <button th:if="${isCheckFollow == 0}" class="followBtn" data-follow="0"
                                value="팔로우">팔로우</button>
                            <button th:unless="${isCheckFollow == 0}" class="followBtn" data-follow="1" value="팔로잉"
                                style="background-color: white; color:black; font-size:11px;">팔로우 취소</button>
                            <img class="modalBtn" src="/css/sns/img/moreIcon.png" style="position: absolute; top:6px; right: 60px; width:30px; height: 30px; cursor: pointer;">
                        </td>
                        <div id="feedCount">
                            <span style="font-size: 13px; color:black">게시글</span>
                            <span class="feedCount" th:text="${snsFeedCount}"></span>&nbsp;&nbsp;
                            <span class="modalBtn">팔로우</span><span class="feedCount"
                                th:text="${snsFollow}"></span>&nbsp;&nbsp;
                            <span class="modalBtn">팔로워</span><span class="feedCount" th:text="${snsFollower}"
                                id="followerCnt"></span>
                        </div>
                        <div id="profileContent">
                            <div th:if="${snsInfo.snsProfile != null}">
                                <span class="feed-content" th:text="${snsInfo.snsProfile}" value="summary"></span>
                                <a href="#" class="btn-more">더보기</a>
                            </div>
                            <div th:unless="${snsInfo.snsProfile != null}">프로필 소개글을입력하세요.</div>

                            <div th:if="${snsInfo.snsWebsite != null}">
                                <a th:href="${snsInfo.snsWebsite}" th:text="${snsInfo.snsWebsite}"
                                    style="color: skyblue;"></a></div>
                            <div th:unless="${snsInfo.snsWebsite != null}">          </div>
                        </div>
                    </div>

                    <!-- 스토리 등록-->
                    <div th:if="${userId.snsNickname == snsInfo.snsNickname}" class="modal">
                        <div class="modal-content"  style="width: 500px; height: 680px;">
                            <span class="close">x</span>
                            <p></p>
                            <form action="/own/snsStory" method="post" enctype="multipart/form-data">
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                                <div><p style="border-bottom: 1px solid lightgray; font-size: 20px; font-weight: 600; text-align: center; padding-bottom: 20px;"> 스토리 작성</p></div>
                                <br>
                                <input name="uploadStory" type="file" class="imgInp" id="imgInp" style="display: none;">
                                <div class="storyImgBox">
                                <label for="imgInp" style="cursor: pointer; color: lightgray; position: absolute;top:49%; left:37%; font-size: 30px;">이미지 첨부</label>
                                <img src="/css/sns/img/cameraIcon1.png" style="width: 50px; height: 50px; position: absolute; top:42%; left: 46%;">
                                </div>
                                <div style="width:460px; height: 460px;">
                                <img class="blah" style="width: 460px; height: 460px; object-fit: cover;"/>
                                </div>
                                <input th:value="${userId.snsNickname}" name="snsNickname" type="hidden">
                                <input th:value="${userId.snsAccountNo}" name="snsAccountNo" type="hidden">
                                
                                <input type="submit" role="button" value="확인" class="snsFeedWriteBtn" style="bottom: 2%; width: 465px; font-size: 18px; font-weight: 600;"/>
                            </form>
                        </div>
                    </div>

                    <!-- 다른사람 스토리-->
                    <div class="modal" th:if="${!#lists.isEmpty(snsStoryList)}">
                        <div class="modal-content" style="width: 500px; height: 600px;" >
                            <div class="storyDelBox">

                            </div>
                            
                            <div class="storyProfile" style="position:relative; width: 450px; height: 60px;">
                                <span class="close" style="padding-left: 16px; padding-top:2px;">x</span>
                            </div>
                            <div class="storyContent" style="position:relative; width:498px; height: 500px;">

                            </div>
                        </div>닉네임
                    </div>

                    <!-- 프로필 -->
                    <div th:if="${userId.snsNickname == snsInfo.snsNickname}" class="modal">
                        <div class="modal-content" style="height:680px;">
                            <span class="close">x</span>
                            <div><p style="border-bottom: 1px solid lightgray; font-size: 20px; font-weight: 600; text-align: center; padding-bottom: 20px;">프로필 편집</p></div>
                            <br>
                            <form id="form1" action="/own/snsProfile" method="post" enctype="multipart/form-data"  style="position:relative;">
                                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                                    <input th:value="${userId.snsAccountNo}" name="snsAccountNo" type="hidden">
                                <div class="snsImageBox">
                                    <img src="/css/sns/img/defaultUser.png" style="width: 250px; height: 250px; position: absolute; right:25%;">
                                    <p style="font-size:13px; color:lightgray; position: absolute; right: 32%; top:47%">프로필 사진을 등록해 보세요!</p>
                                </div>
                                <div style="width: 300px; height: 300px; border-radius: 50%;" >
                                    <img class="blah" style="width: 250px; height: 250px; border-radius: 50%; object-fit: cover; border: 1px solid black; position: absolute; top: 0px; right: 25%;"/>
                                </div>
                                    <input name="uploadProfile" type="file" class="imgInp" id="uploadProfile" style="display: none;"/>
                                        <label id="fileLabel" for="uploadProfile">사진 변경</label>
                                <div class="nicknameBox" >
                                    <input type="text" th:value="${userId.snsNickname}" name="snsNickname" style="width:480px; padding:10px; border-radius: 0px; border-top: 1px soild black; border-bottom: 1px soild black; color: gray;">
                                </div>
                                    <textarea id="profileTextBox" name="snsProfile"th:text="${snsInfo.snsProfile}" placeholder="프로필 소개글을 입력하세요." style="border-bottom: 1px soild black; border-radius: 0px; color: gray;"></textarea>
                                <div class="textLengthWarp" style="position: absolute; top:408px; right:-25px; width: 100px;">
                                    <span id="profileTextCount">0</span>
                                    <span id="profileTextTotal">/100</span>
                                </div>
                                    <textarea id="websiteLink" name="snsWebsite" th:text="${snsInfo.snsWebsite}" placeholder="웹사이트 링크를 입력하세요.">  </textarea>   
                                    <input type="submit" role="button" value="확인" id="profileUpdateBtn" style="display: none;"/>
                                    <label for="profileUpdateBtn" id="updateLabel">수정</label>
                            </form>
                        </div>
                    </div>
                    

                    <!--신고모달-->
                    <div th:if="${userId.snsNickname != snsInfo.snsNickname}" class="modal">
                        <div class="modal-content" style="width: 400px; height: 600px;">
                            <span class="close">x</span>
                             <h4 style="text-align: center; font-weight: 600; border-bottom:1px solid lightgray; padding-bottom:20px;">SNS 유저 신고하기</h4>
							       <div id = "container">
							       <form role="form"  autocomplete="off" style="width: 80%;"enctype="multipart/form-data" name="frm" id="frm">
									<input type="hidden" th:name="${_csrf.parameterName}"th:value="${_csrf.token}">
							        <input type="hidden" th:value="${session.loginUser.userId}" id="reporter" name="reporter">
							        <input type="hidden" th:value="${snsInfo.userId}" id="dereporter" name="dereporter">
							        <div class="input-form-backgroud row">
							            <div class="input-form col-md-12 mx-auto" style="padding-left:40px; font-weight: 600;">
							              <span class="mb-3">신고 대상</span>
							              	<input type="text" th:value="${snsInfo.snsNickname}" disabled style="margin-bottom:20px"/>
	
							                    <label for="reason">신고사유 *</label>
                                                <br>
							                    <select id="reason" name="reason" style="margin-bottom:20px">
							                    	<option selected>:: 신고사유를 선택해주세요 ::</option>
							                        <option value="욕설">욕설</option>
							                        <option value="광고">광고</option>
							                        <option value="부적절한 아이디">부적절한 아이디</option>
							                    </select>
                                                <br>
												<label for="name" style="margin-top:20px; ">Date *</label> <input type="text" class="form-control"
													id="vldname" th:value="${#calendars.format(#calendars.createNow(), 'yyyy-MM-dd')}"
														readonly style="margin-bottom:40px;"/>
							                    <label for="code">신고 증거 사진 첨부</label>
							                    <input name="uploadfile" type="file" id="uploadfile" multiple="multiple" style="margin-bottom:40px;">
							                <button type="button" id="btnreporting">신고</button>      
							                <button type="button" id="btnsignin">취소</button>              
							            </div>
							        </div>
							        </form>
							        </div>
                        </div>
                    </div>


                    <!-- 팔로우 Modal -->
                    <div class="modal">
                        <div class="modal-content" style="width:550px;">
                            <span class="close">x</span>
                            <p style="text-align: center; border-bottom: 1px solid lightgray;">팔로우 목록</p>
                                    <th:block th:each="snsfol : ${snsFollowerList}">
                                        <div class="snsfolProfile" style="padding-bottom: 15px;">
                                            <img th:src="|/imgView/${snsfol.mediaServerFile}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 50%; " onerror='this.src="/css/sns/img/defaultUser.png"'>
                                            <a th:href="@{snsFeed(snsNickname=${snsfol.follower})}">[[${snsfol.follower}]]</a>
                                            <input th:if="${userId.snsNickname == snsInfo.snsNickname}" class="followDelbtn" type="button" value="삭제">
                                        </div>
                                    </th:block>
                        </div>
                    </div>
                    <!-- 팔로워 Modal -->
                    <div class="modal">
                        <div class="modal-content" style="width:550px;">
                            <span class="close">x</span>
                            <p style="text-align: center; border-bottom: 1px solid lightgray;">팔로워 목록</p>
                                    <td th:each="snsf : ${snsFollowList}">
                                        <div class="snsfProfile" style="padding-bottom: 15px;">
                                            <img th:src="|/imgView/${snsf.mediaServerFile}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 50%;" onerror='this.src="/css/sns/img/defaultUser.png"'>
                                            <a th:href="@{snsFeed(snsNickname=${snsf.follow})}">[[${snsf.follow}]]</a>
                                            <input th:if="${userId.snsNickname == snsInfo.snsNickname}" class="followDelbtn" type="button" value="삭제">
                                        </div>
                                    </td>
                            </div>
                        </div>
                    </div>
                    <hr>
         
                <!-- 글작성 모달을 여는 클래스 -->
                <h1 th:if="${userId.snsNickname == snsInfo.snsNickname}" class="modalBtn" style="text-align: right; cursor:pointer; font-size: 16px; font-weight: 600;">
               		 📝글쓰기</h1>
                <p>
                    <div th:if="${userId.snsNickname == snsInfo.snsNickname}" class="modal">
                        <div class="modal-content" style="min-height: 880px; width:30%;">
                            <span class="close">x</span>
                            <div><p style="border-bottom: 1px solid lightgray; font-size: 20px; font-weight: 600; text-align: center; padding-bottom: 20px;">새 게시물 작성</p></div>
                            <div id="image_preview">
                                <!--이미지 미리보기-->
                                <form action="/own/snsWriteFeed" method="post" class="snsWriteFrm" enctype="multipart/form-data" onsubmit="return feedFormCheck()">
                                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                                    <input name="uploadfile" type="file" id="btnAtt" multiple="multiple" required style="display: none;">
                                    <label for="btnAtt" style="cursor: pointer; color: lightgray; position: absolute;top:41%; left:38%; font-size: 30px;">이미지 첨부</label>
                                    <img src="/css/sns/img/cameraIcon1.png" style="width: 50px; height: 50px; position: absolute; top:36%; left: 46%;">
                                    <p id="demo"></p>
                                    <div id="att_zone"></div>
                                    <br>
                                        <textarea style="width: 530px; height: 200px; position: absolute; padding:20px;" name="snsBoardContent"
                                            id="textBox" placeholder="내용을 입력하세요." required></textarea>
                                        <div class="textLengthWarp" style="position: absolute; top:69%; right:3px; width:100px; z-index: 22;">
                                            <span id="textCount">0자</span>
                                            <span id="textTotal">/500자</span>
                                        </div>
                                            <input th:value="${userId.snsAccountNo}" name="snsAccountNo" type="hidden"></input>
                                            <input th:value="${userId.snsNickname}" type="hidden" name="snsNickname" />
                                        
                                        <input type="submit" role="button" value="글쓰기" class="snsFeedWriteBtn" />
                                    </form>
                                </div>
                        </div>
                    </div>
                    <br>
                    <div class="portfolio gutters grid img-container" th:if="${!#lists.isEmpty(snsImg)}">
                        <div class="grid-sizer col-sm-12 col-md-6 col-lg-3"></div>
					
                        <th:block th:each="snsimg :${snsImg}">
                                <div class="grid-item branding  col-sm-12 col-md-6 col-lg-3" >
                                    <div class="project_box_one">
                                        <img th:src="|/imgView/${snsimg.mediaServerFile}" />
                                        <div class="product_info"  th:value="${snsimg.identifyId}">
                                            <div class="product_info_text">
                                                <div class="product_info_text_inner">
                                                    <th:block th:each="snsFeed : ${snsFeed}" th:if="${#strings.substring(snsimg.identifyId,4) == snsFeed.snsBoardNo}">
                                                    <i class="fa fa-regular fa-heart" style="color:white"></i>
                                                    <span th:text="${snsFeed.likeCount}" style="font-size: 13px; color: white; margin-right: 20px; font-weight: 600; margin-left:4px;"></span>
                                                    <i class="fa fa-regular fa-comment-dots" style="color:white"></i>
                                                    <span th:text="${snsFeed.replyCount}" style="font-size: 13px; color: white;  margin-right: 10px; font-weight: 600; margin-left:4px;"></span>
                                                    </th:block>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--</a>-->
                            </th:block>
                    </div>
                    <div th:unless="${!#lists.isEmpty(snsImg)}" style="width:630px; margin-left: 320px;">
                        <img style="margin-top: 100px; margin-left: 250px;" src="/css/sns/img/camera.png" alt="blog title " />
                        <p style="text-align: center; font-size: 22px; font-weight: 800;">게시물 없음</p>
                        <p style="text-align: center; font-size: 20px; color: lightgray; font-weight: 600;">첫 게시물을 등록해보세요!</p>
                    </div>


                    <!-- 게시글 상세보기 Modal -->                  
                        <div class="Feedmodal">
                            <div class="Feedmodal-content" style="width: 1100px; min-height: 700px; position: relative;">
                                <span class="close"></span>
                                <div class="boardContent" style="float: right; width: 500px; min-height:180px; border-bottom: 1px lightgray solid; padding-bottom: 35px;">
                                  
                                </div>
                                <div class="snsLikeBox" style="width:100px; display: inline-block; position: absolute; top:175px; right: 95px;">
                                </div>
                                <div class="snsReplyBox" style="width:100px; display: inline-block; position: absolute; top:177px; right: -7px;">
                                    <img id="snsReplyIcon" src="/css/sns/img/speechImg.png" style="width: 20px; height: 20px;" >
                                </div>
                                <div class="boardImgList" style="position:relative; width: 500px; height: 600px; float:left">
                                </div>
                                <div class="replyContent" style="width:500px; float: right; border-bottom: 1px lightgray solid; padding-top: 16px; padding-bottom: 16px; margin-bottom: 10px;">
                                </div>   
                                <div class="replyInsert" style="width:500px; height: 200px;float:right;">
                                    
                                    <div class="realReply"></div>
                                </div>
                                <div class="container-dots">
                                    <ul class="dots-parent" style="list-style: none; margin-left: 150px; width: 300px; height: 50px;">
                                        
                                    </ul>
                                </div>

                                <div class="btnIcon" th:if="${userId.snsNickname == snsInfo.snsNickname}">
                                    <img src="/css/sns/img/trash.png" id="trashBtn" style="width: 20px; height: 20px; cursor: pointer; position: absolute; top:17px; right:167px;" >
                                </div>
                                
                            </div>
                        </div>
                    <!--=================== filter portfolio end====================-->
            </div>
            <!--=================== content body end ====================-->
        </div>
    </div>
    <!--===================스크립트====================-->
    <script th:inline="javascript">
        /*<![CDATA[*/
        var header = /*[[${_csrf.headerName}]]*/ 'defalut';
        var token = /*[[${_csrf.token}]]*/ 'defalut';
        /*]]>*/

        
        //로그인 정보 유저 id
        var loginUserId = "[(${userId.userId})]"
        //로그인 정보 sns 닉네임
        var loginNickname = "[(${userId.snsNickname})]"
        var categoryNo = '';

        //게시글 더보기
        $('.btn-more').on("click",function(){
            console.log("더보기 버튼 클릭")
            if($('.feed-content').attr("value")=="summary"){
                $('.feed-content').addClass("more");
                $('.feed-content').attr("value", "more")
                $('.btn-more').text("접기");
            }else{
                $('.feed-content').removeClass("more");
                $('.feed-content').attr("value", "summary")
                $('.btn-more').text("더보기");

            }
        })

        $('.followDelbtn').on("click", function(){
            console.log("팔로우 삭제버튼 클릭");
            console.log($(this).parent());
            $(this).parent().hide();
        })
        //신고
        $('#btnsignin').on('click',function(){
                console.log('취소');
            })

        $('#btnreporting').on('click',function(){   
            let formData = new FormData(document.frm);
            console.log("신고 클릭")
            $.ajax({
                url: '/common/report',
                method: 'post',
                data : formData,
                cache: false,
                    contentType: false,
                    processData: false,
                beforeSend: function(xhr){
                xhr.setRequestHeader(header,token);
                }
            }).then(res=>{
                console.log(res)          
            })	
        })

        //게시글 글자수

        $('#textBox').keydown(function (e) {
            let content = $(this).val();
            
            // 글자수 세기
            if (content.length == 0 || content == '') {
                $('#textCount').text('0자');
            } else {
                $('#textCount').text(content.length + '자');
            }
            
            // 글자수 제한
            if (content.length > 499) {
                // 500자 부터는 타이핑 되지 않도록
                $(this).val($(this).val().substring(0, 499));    
                alert('500자까지 입력 가능합니다.');
            };
        });

        //프로필 글자수
        $('#profileTextBox').keydown(function (e) {
            let content = $(this).val();
            
            // 글자수 세기
            if (content.length == 0 || content == '') {
                $('#profileTextCount').text('0자');
            } else {
                $('#profileTextCount').text(content.length + '자');
            }
            
            // 글자수 제한
            if (content.length > 100) {
                // 500자 부터는 타이핑 되지 않도록
                $(this).val($(this).val().substring(0, 100));    
                alert('100자까지 입력 가능합니다.');
            };
        });

        //이미지미리보기
        $(function() {
            $(".imgInp").on('change', function(){
                readURL(this);
                $('.storyImgBox').hide()
            });
        });

        function readURL(input) {
            if (input.files && input.files[0]) {
            var reader = new FileReader();
            
            reader.onload = function (e) {
                    $('.blah').attr('src', e.target.result);
                    

                }

              reader.readAsDataURL(input.files[0]);
            }
        };      
    
    //좋아요 ajax
        $('.snsLikeBox').on("click", '#snsLikeBtn', function(){
            console.log("하트 클릭")
            console.log($(this).attr("value"))
            $('.snsLikeBox').children('#snsLikeCount').remove();
                if($(this).attr("value") == 'noLike'){
                    console.log('빈하트 클릭')
                    $(this).attr("value", "Like");
                    $(this).attr({"src" : "/css/sns/img/fullHeart.png"});
                        $.ajax({
                            url : '/own/snsLike' ,
                            method : 'post',
                            data : {
                                snsBoardNo : categoryNo,
                                userId : loginUserId
                            },
                            beforeSend: function (xhr) {
                                xhr.setRequestHeader(header, token);
                            },
                            success : function(res){
                                console.log('좋아요 성공~!')
                                let snsLikeCount = $('<span>').text("좋아요 "+res+"개");
                                    snsLikeCount.attr({"id" : "snsLikeCount"})
                                    $('.snsLikeBox').eq(0).append(snsLikeCount)
                            },
                            error : function(err){
                                console.log(err)
                            }
                        })
                }else{
                    console.log("하트 클릭")
                    $(this).attr("value", "noLike");
                    $(this).attr({"src": "/css/sns/img/emptyHeart.png"});
                        $.ajax({
                            url : '/own/snsLikeDel',
                            method : 'post',
                            data : {
                                snsBoardNo : categoryNo,
                                userId : loginUserId
                            },
                            beforeSend: function (xhr) {
                                xhr.setRequestHeader(header, token);
                            },
                            success : function(res){
                                console.log('좋아요 취소~!')
                                
                                let snsLikeCount = $('<span>').text("좋아요 "+res+"개");
                                    snsLikeCount.attr({"id" : "snsLikeCount"})
                                    $('.snsLikeBox').eq(0).append(snsLikeCount)
                            },
                            error : function(err){
                                console.log(err)
                            }

                        })
                }

        })


    //댓글 입력 창 생성
    $('.replyInsert').on("click",'.replyInput', function(e){
        console.log('댓글쓰기 버튼 클릭')

        $(e.target).remove();
            let replyArea = $('<textarea>').css({"width":"500px","height" : "100px", "padding":"15px"})
                replyArea.attr({"class":"replyText"})
            let insertBtn = $('<button>').text("입력")
                insertBtn.attr({"class": "insertBtn"})
            let delBtn = $('<button>').text("취소")
                delBtn.attr({"class" : "delBtn"})

            $('.realReply').append(replyArea, insertBtn, delBtn);

    })
    //댓글 입력
        $('.realReply').on("click", '.insertBtn', function(){
                let replyText = $('.realReply').children('.replyText').val();
                $('.replyContent').children().remove();
                $('.snsReplyBox').children().eq(1).remove();
                $.ajax({
                    url : '/own/snsReply',
                    method : 'post',
                    data: {
                        replyContent : replyText,
                        userId : loginUserId,
                        categoryNo : categoryNo
                    },  
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader(header, token);
                    },
                    success: function(res){
                        console.log(res)

                        for(let i=0; i<res.reply.length; i++){
                            $('.replyContent').append(makeReply(res.reply[i]));
                        }
                        $('.replyInsert').children('.realReply').children().remove();
                        $('.replyInsert').children('.replyInput').remove();
                        let replyInput = $('<div>').text('댓글쓰기');
                            replyInput.attr({"class" : "replyInput"})
                        $('.realReply').append(replyInput);
                    let snsReplyCount = $('<span>').text("댓글 "+res.snsReplyCount +"개");
                        snsReplyCount.css("id", "snsReplyCount")
                    $('.snsReplyBox').append(snsReplyCount)

                    },
                    error : function(err){
                        console.log(err);
                    }

                })
        })

        //댓글취소
        $('.realReply').on("click", '.delBtn', function(){
            console.log("취소버튼 클릭")
            $('.replyInsert').children('.realReply').children().remove();
            $('.replyInsert').children('.replyInput').remove();
            let replyInput = $('<div>').text('댓글쓰기');
                replyInput.attr({"class" : "replyInput"})
            $('.realReply').append(replyInput);
            
        })

        //댓글 삭제
        $('.replyContent').on("click", '.snsReplyDelBtn', function(e){
                let replyNo = $('.replyContent').children().children('.snsReplyNo').val();
                console.log(replyNo)
                if(window.confirm("정말 삭제하시겠습니까?")){
                $('.replyContent').children().remove();
                $('.snsReplyBox').children().eq(1).remove();
                $.ajax({
                    url : '/own/snsReplyDelete',
                    method : 'post',
                    data : {
                           replyNo : replyNo,
                           categoryNo : categoryNo
                    },
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader(header, token);
                    },
                        success : function(res){
                            console.log("삭제완료")
                        
                        if(res.reply.length != 0 ){
                          for(let i=0; i<res.reply.length; i++){
                                $('.replyContent').append(makeReply(res.reply[i]));
                          }
                          
                        }else{
                            let emptyReply = $('<div>').text("등록된 댓글이 없습니다.")
                                $('.replyContent').append(emptyReply);
                            }
                            let snsReplyCount = $('<span>').text("댓글 "+res.snsReplyCount +"개");
                            $('.snsReplyBox').append(snsReplyCount)

                    }, 
                        error : function(err){

                    }

                })
            }else{
                console.log("댓글 삭제 취소")
            }
        })


    //게시글 한건 삭제 
        $('#trashBtn').on("click", function () {
            console.log('쓰레기통버튼 클릭')
            let bNo = $('.boardContent').children('.boardNo').attr("value");
            console.log(bNo)
            if (window.confirm("정말 삭제하시겠습니까?")) {
                console.log("네")
                $.ajax({
                    url: '/own/boardDelete',
                    method: 'post',
                    data: {
                        snsBoardNo: bNo
                    },
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader(header, token);
                    },
                    success: function (res) {
                        $('.modal').css({
                            "display": "none"
                        });
                        location.href = "/own/snsFeed";
                        alert("삭제 완료")

                    },
                    error: function (err) {
                        console.log(err)
                    }
                })
            } else {
                console.log("아니오")
            }
        })
        $('#updateBtn').on("click", function () {
            console.log('업데이트버튼 클릭')
        })

        var followId = "[(${snsInfo.snsAccountNo})]"
        var followerId = "[(${userId.snsAccountNo})]"
        var followNickname = "[(${snsInfo.snsNickname})]"
    
    //게시글 상세보기 이미지 페이징
        $('.dots-parent').on("click", '.dot', function(e){
            let btnData = $(e.target).attr("data-item");
            $('.dot').not(this).removeClass("active");
            $(this).addClass("active");
            $('.boardImg').not('[data-item="'+btnData+'"]').removeClass("active")
            $('.boardImg[data-item="'+btnData+'"]').addClass("active")
        })
        //팔로우버튼
        $('.followBtn').on("click", function () {
            if (this.value == '팔로우') {
                console.log('팔로우버튼 클릭');
                this.style.backgroundColor = "white";
                this.style.color = "black";
                this.value = '팔로잉';
                this.textContent = "팔로우 취소";
                $.ajax({
                    url: '/own/follow',
                    method: 'post',
                    data: {
                        snsFollowId: followId,
                        snsFollowerId: followerId,
                        nickname: followNickname
                    },
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader(header, token);
                    },
                    success: function (res) {
                        console.log(res)
                        $('#followerCnt').text(res);
                    },
                    error: function (err) {
                        console.log(err);
                    }

                })

            } else if (this.value == '팔로잉') {
                console.log('팔로잉버튼 클릭')
                this.style.backgroundColor = "skyblue";
                this.style.color = "white";
                this.value = "팔로우";
                this.textContent = "팔로우";
                $.ajax({
                    url: '/own/unfollow',
                    method: 'post',
                    data: {
                        snsFollowId: followId,
                        snsFollowerId: followerId,
                        nickname: followNickname
                    },
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader(header, token);
                    },
                    success: function (res) {
                        console.log("언팔완")
                        $('#followerCnt').text(res);
                    },
                    error: function (err) {
                        console.log(err);
                    }
                })
            }
        })

        //스토리 상세보기 ajax
        $('.profileImg').on("click", function () {
            console.log(followNickname); //위에 선언되어있는 피드 sns 닉네임
            $.ajax({
                url: '/own/snsStoryList',
                method: 'post',
                data: {
                    snsNickname: followNickname
                },
                beforeSend: function (xhr) {
                    xhr.setRequestHeader(header, token);
                },
                success: function (res) {
                    console.log(res);
                    console.log(res.storyInfo)
                    let storyProfileImg="";
                    
                    if(res.profileImg != null){
                        storyProfileImg = $('<img>').attr({
                        "src": "/imgView/" + res.profileImg.mediaServerFile,
                        "class": "storyProfileImg"})
                    }else{
                        storyProfileImg = $('<img>').attr({
                            "src": "/css/sns/img/defaultUser.png",
                            "class": "storyProfileImg"})
                    }
                    if(res.storyInfo.length != 0){
                        let storyProfileName = $('<span>').text(res.storyInfo[0].snsNickname)
                        storyProfileName.attr('class', "storyProfileName")
                        $('.storyProfile').append(storyProfileImg, storyProfileName);
                            
                        for (let i = 0;  i < res.storyImg.length; i++) {
                            let storyImg = $('<img>').attr({
                                "src": "/imgView/" + res.storyImg[i].mediaServerFile,
                                "class": "storyImg",
                                "page-name": i
                            })
                            console.log("스토리번호"+ res.storyInfo[i].snsStoryNo)
                            let storyProfileDate = $('<span>').text(elapsedText(res.storyInfo[i].snsStoryDate));
                                storyProfileDate.attr({'class': "storyProfileDate",
                                                    "page-name": i});
                                                    $('.storyProfile').append(storyProfileDate);
                                                    $('.storyContent').append(storyImg);
                                                    
                                if(loginNickname == res.storyInfo[0].snsNickname){
                                    let snsStoryDel = $('<span>').text("스토리 삭제")
                                        snsStoryDel.attr({"class" : "snsStoryDel",
                                                          "page-name" : i,
                                                          "value" : res.storyInfo[i].snsStoryNo})
                                        snsStoryDel.css("cursor", "pointer");
                                        $('.storyDelBox').append(snsStoryDel);
    
                                    }
                                }

                                $('.storyProfile').children(".storyProfileDate").eq(0).addClass("active")
                                $('.storyContent').children(".storyImg").eq(0).addClass("active")
                                $('.storyDelBox').children(".snsStoryDel").eq(0).addClass("active")

                        }else{
                            let defaultImg = $('<img>').attr({"src" : "/css/sns/img/feedDefaultImg.png"})
                                defaultImg.css({"width":"300px",
                                                "position": "absolute",
                                                "left" : "79px"});
                                $('.storyContent').append(defaultImg);
                            console.log('등록된 스토리가 없습니다.');

                        }

                        },
                error: function (err) {
                    console.log(err)
                }
            })
        })
    
        //스토리 삭제 후 조회 
        $('.storyDelBox').on("click", '.snsStoryDel', function(){
                console.log("스토리 삭제입니다");
                let snsStoryNo = $('.storyDelBox').children('.snsStoryDel.active').attr("value")
                console.log(snsStoryNo);
            if(window.confirm("정말 삭제하시겠습니까?")){
                $('.sotryDelBox').children().remove();

                $.ajax({
                url: '/own/snsStoryDel',
                method: 'post',
                data: {
                    snsNickname: followNickname,
                    snsStoryNo : snsStoryNo
                },
                beforeSend: function (xhr) {
                    xhr.setRequestHeader(header, token);
                },
                success: function (res) {
                    alert("스토리 삭제가 완료되었습니다.")
                    $('.storyProfile').children('.storyProfileDate').remove();
                    $('.storyProfile').children('.storyProfileImg').remove();
                    $('.storyProfile').children('.storyProfileName').remove();
                    $('.storyContent').children().remove();
                    console.log(res);
                    console.log(res.storyInfo)
                    let storyProfileImg="";
                    
                    if(res.profileImg != null){
                        storyProfileImg = $('<img>').attr({
                        "src": "/imgView/" + res.profileImg.mediaServerFile,
                        "class": "storyProfileImg"})
                    }else{
                        storyProfileImg = $('<img>').attr({
                            "src": "/css/sns/img/defaultUser.png",
                            "class": "storyProfileImg"})
                    }
                    if(res.storyInfo.length != 0){
                        let storyProfileName = $('<span>').text(res.storyInfo[0].snsNickname)
                        storyProfileName.attr('class', "storyProfileName")
                        $('.storyProfile').append(storyProfileImg, storyProfileName);
                            
                        for (let i = 0;  i < res.storyImg.length; i++) {
                            let storyImg = $('<img>').attr({
                                "src": "/imgView/" + res.storyImg[i].mediaServerFile,
                                "class": "storyImg",
                                "page-name": i
                            })
                            console.log("스토리번호"+ res.storyInfo[i].snsStoryNo)
                            let storyProfileDate = $('<span>').text(elapsedText(res.storyInfo[i].snsStoryDate));
                                storyProfileDate.attr({'class': "storyProfileDate",
                                                    "page-name": i});
                                                    $('.storyProfile').append(storyProfileDate);
                                                    $('.storyContent').append(storyImg);
                                                    
                                if(loginNickname == res.storyInfo[0].snsNickname){
                                    let snsStoryDel = $('<span>').text("스토리 삭제")
                                        snsStoryDel.attr({"class" : "snsStoryDel",
                                                          "page-name" : i,
                                                          "value" : res.storyInfo[i].snsStoryNo})
                                        snsStoryDel.css("cursor", "pointer");
                                        $('.storyDelBox').append(snsStoryDel);
    
                                    }
                                }

                                $('.storyProfile').children(".storyProfileDate").eq(0).addClass("active")
                                $('.storyContent').children(".storyImg").eq(0).addClass("active")
                                $('.storyDelBox').children(".snsStoryDel").eq(0).addClass("active")

                        }else{
                            let defaultImg = $('<img>').attr({"src" : "/css/sns/img/feedDefaultImg.png"})
                                defaultImg.css({"width":"300px",
                                                "position": "absolute",
                                                "left" : "79px"});
                                $('.storyContent').append(defaultImg);
                            console.log('등록된 스토리가 없습니다.');

                        }

                        },
                error: function (err) {
                    console.log(err)
                }
             })
          }
                
        })
        //스토리 게시글 페이징
        $('.storyContent').on("click",function(){
            console.log("스토리 화면 클릭")
            let i = 0;
            //$('.storyContent').children().length 받아온 사진의 갯수 3개 0,1,2이기 때문에 작다고 비교
            //$('.storyContent').children('.storyImg.active').attr("page-name") 현재 active상태인 이미지의 번호
            let allImgLength = $('.storyContent').children().length;
            let activeImgNum = $('.storyContent').children('.storyImg.active').attr("page-name");
            let activeImg = $('.storyContent').children('.storyImg.active');
            let activeDate =$('.storyProfile').children('.storyProfileDate.active');
            let activeDel = $('.storyDelBox').children('.snsStoryDel.active');
            console.log(activeImg)
            console.log(activeImgNum)
            if(activeImgNum < allImgLength - 1){
                console.log("총 이미지 갯수보다 수가 적음")
                activeImg.next().addClass("active");
                activeDate.next().addClass("active");
                activeDel.next().addClass("active");
                activeDate.removeClass("active");
                activeImg.removeClass("active");
                activeDel.removeClass("active");

            }else{
                console.log("첫번째 이미지 active 상태로 하기.")
                $('.storyProfile').children(".storyProfileDate").last().removeClass("active")
                $('.storyContent').children(".storyImg").last().removeClass("active")
                $('.storyDelBox').children('.snsStoryDel').last().removeClass("active")
                $('.storyProfile').children(".storyProfileDate").first().addClass("active")
                $('.storyContent').children(".storyImg").first().addClass("active")
                $('.storyDelBox').children('.snsStoryDel').first().addClass("active")

            }

        })
    


        //게시글 상세 보기 ajax
        $('.portfolio').on("click", '.grid-item', function(e){
            console.log($(this));
            console.log($(e.target).attr("value"));
            let boardNo = $(e.target).attr("value");
            console.log('게시글 클릭입니다')
            if(boardNo != null){
                    $(".Feedmodal").show();
                    console.log("모달 아작스 보냅니다");
                        $.ajax({
                            url : '/own/snsFeed',
                            method : 'post',
                            data: {
                                snsBoardNo : boardNo,
                                userId : loginUserId
                            },
                            beforeSend: function (xhr) {
                                xhr.setRequestHeader(header, token);
                            },
                            success: function (res){
                                console.log(res);
                                let boardNo = $('<div>').attr({"value": res.svo.snsBoardNo,
                                                               "class" : "boardNo"});
                                let boardDate = $('<div>').text(res.svo.snsBoardDate);
                                    boardDate.css({"text-align": "right", "color":"darkgray", "padding-bottom":"20px"});
                                let boardContent = $('<div>').text(res.svo.snsBoardContent);
                                    boardContent.css({"border-top":"1px solid lightgray", "padding-top":"15px"})
                                     $('.boardContent').append(boardNo, boardDate, boardContent);
                                
                                for(let i=res.imgList.length-1; i>= 0; i--){
                                    let boardImg = $('<img>').attr({
                                        "src" : "/imgView/" + res.imgList[i].mediaServerFile,
                                        "class": "boardImg",
                                        "data-item" : i})
                                        boardImg.css({"width":"500px", "height":"600px", "object-fit":"cover",
                                                      "position" : "absolute"})
                                    
                                    $('.boardImgList').append(boardImg);  
                                }
                                for(let i=0; i<res.imgList.length; i++){
                                    let liTag = $('<li>').attr({"data-item" : i,
                                                                "class" : "dot"})
                                        liTag.css({"width":"20px", "height" : "20px", 
                                                   "border-radius":"50%","cursor" :"pointer",
                                                   "float" : "left"})
                                    $('.dots-parent').append(liTag);
                                }

                                $(".boardImgList .boardImg:last-child").addClass("active");
                                $(".dots-parent .dot:first-child").addClass("active");

                                if(res.reply.length != 0){
                                    for(let i=0; i<res.reply.length; i++){
                                        $('.replyContent').append(makeReply(res.reply[i]));
                                    }

                                }else{
                                    console.log('여기까지오나요?')
                                    let emptyReply = $('<div>').text("등록된 댓글이 없습니다.")
                                        $('.replyContent').append(emptyReply);
                                }

                                    let replyInput = $('<div>').attr({"class" : "replyInput"})
                                        replyInput.css({"cursor": "pointer"})
                                        replyInput.text('댓글쓰기')
                                        $('.realReply').append(replyInput);
                                    categoryNo = boardNo.attr("value");

                                if(res.snsLikeCheck != null){
                                    let snsLikeImg = $('<img>').attr({"src" : "/css/sns/img/fullHeart.png",
                                                                       "id" : "snsLikeBtn",
                                                                       "value" : "Like"})
                                        $('.snsLikeBox').append(snsLikeImg);
                                }else {
                                    let snsLikeImg = $('<img>').attr({"src" : "/css/sns/img/emptyHeart.png",
                                                                       "id" : "snsLikeBtn",
                                                                       "value" : "noLike"})
                                        $('.snsLikeBox').append(snsLikeImg);
                                }
                                
                                let snsLikeCount = $('<span>').text("좋아요 "+res.snsLikeCount+"개");
                                    snsLikeCount.attr("id" , "snsLikeCount");

                                let snsReplyCount = $('<span>').text("댓글 "+res.snsReplyCount +"개");
                                    snsReplyCount.attr("id","snsReplyCount")
                                    $('.snsLikeBox').append(snsLikeCount);
                                    $('.snsReplyBox').append(snsReplyCount)
                                
                            },error: function (err){
                                console.log(err)
                            }
                        })
                }else{
                    console.log("잘못클릭")
                }
        })
        
        function makeReply(reply){
            let Tag = ` <div class="replyIdDate" style="padding-top:10px" >${reply.snsNickname} |    ${reply.replyDate} 
                        <input class="snsReplyNo" type="hidden" value="${reply.replyNo}" /></div> 
                        <div style="padding-left:20px;">${reply.replyContent}</div>`
            console.log(reply.snsNickname)
            console.log(reply.userId)

            if(reply.userId == loginUserId){
                console.log("x태그 생성")
                let xTag = `<div class="snsReplyDelBtn" style="font-size:11px; padding-left:440px; cursor:pointer; color:blue;">댓글 삭제</div>`
                    Tag = Tag+xTag;
            }
                return Tag;


        }
   
              
        // Modal을 가져옵니다.
        var modals = document.getElementsByClassName("modal");
        // Modal을 띄우는 클래스 이름을 가져옵니다.
        var btns = document.getElementsByClassName("modalBtn");
        // Modal을 닫는 close 클래스를 가져옵니다.
        var spanes = document.getElementsByClassName("close");
        var funcs = [];

        // Modal을 띄우고 닫는 클릭 이벤트를 정의한 함수
        function Modal(num) {
            return function () {
                // 해당 클래스의 내용을 클릭하면 Modal을 띄웁니다.
                btns[num].onclick = function () {
                    modals[num].style.display = "block";
                    event.stopPropagation();
                    console.log(num);

                };

                // <span> 태그(X 버튼)를 클릭하면 Modal이 닫습니다.
                spanes[num].onclick = function () {
                    console.log('모달닫기버튼클릭')
                    modals[num].style.display = "none";
                    $('.storyContent').children('img').remove();
                    $('.storyProfile').children().not('.close').remove();
                    $('.blah').attr('src', "");
                };
            };
        }

        // 원하는 Modal 수만큼 Modal 함수를 호출해서 funcs 함수에 정의합니다.
        for (var i = 0; i < btns.length; i++) {
            funcs[i] = Modal(i);
        }

        // 원하는 Modal 수만큼 funcs 함수를 호출합니다.
        for (var j = 0; j < btns.length; j++) {
            funcs[j]();
        }

        window.onclick = function (event) {
            if (event.target.className == "Feedmodal") {
                event.target.style.display = "none";
                $('.boardContent').children().remove();
                $('.boardImgList').children().remove();
                $('.dots-parent').children().remove();
                $('.replyContent').children().remove();
                $('.realReply').children().remove();
                $('.snsLikeBox').children().remove();
                $('.snsReplyBox').children().eq(1).remove();
                
            }
        };

        //첨부파일 이미지 
        ( /* att_zone : 이미지들이 들어갈 위치 id, btn : file tag id */
            imageView = function imageView(att_zone, btn) {

                var attZone = document.getElementById(att_zone);
                var btnAtt = document.getElementById(btn)
                var sel_files = [];

                // 이미지와 체크 박스를 감싸고 있는 div 속성
                var div_style = 'display:inline-block;position:relative;' +
                    'width:240px;height:200px;margin:5px;border:1px solid white;z-index:1;object-fit:cover';
                // 미리보기 이미지 속성
                var img_style = 'width:100%;height:100%;z-index:none';
                // 이미지안에 표시되는 체크박스의 속성
                var chk_style = 'width:30px;height:30px;position:absolute;font-size:18px;' +
                    'right:0px;bottom:0px;z-index:999;background-color:lightgray;color:white; border:none; opacity:0.9; cursor:pointer;';

                btnAtt.onchange = function (e) {
                    var files = e.target.files;
                    var fileArr = Array.prototype.slice.call(files)
                    var x = document.getElementById("btnAtt");
                    var txt = "";
                    if ('files' in x) {
                        if (x.files.length > 4) {
                            alert("파일 개수가 초과되었습니다.");
                            document.getElementById("btnAtt").value = "";
                            return;
                        }
                    }
                    for (f of fileArr) {
                        imageLoader(f);
                    }
                }


                // 탐색기에서 드래그앤 드롭 사용
                attZone.addEventListener('dragenter', function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                }, false)

                attZone.addEventListener('dragover', function (e) {
                    e.preventDefault();
                    e.stopPropagation();

                }, false)

                attZone.addEventListener('drop', function (e) {
                    var files = {};
                    e.preventDefault();
                    e.stopPropagation();
                    var dt = e.dataTransfer;
                    files = dt.files;
                    for (f of files) {
                        imageLoader(f);
                    }

                }, false)



                /*첨부된 이미리즐을 배열에 넣고 미리보기 */
                imageLoader = function (file) {
                    sel_files.push(file);
                    var reader = new FileReader();
                    reader.onload = function (ee) {
                        let img = document.createElement('img')
                        img.setAttribute('style', img_style)
                        img.src = ee.target.result;
                        attZone.appendChild(makeDiv(img, file));
                    }

                    reader.readAsDataURL(file);
                }

                /*첨부된 파일이 있는 경우 checkbox와 함께 attZone에 추가할 div를 만들어 반환 */
                makeDiv = function (img, file) {
                    var div = document.createElement('div')
                    div.setAttribute('style', div_style)

                    var btn = document.createElement('input')
                    btn.setAttribute('type', 'button')
                    btn.setAttribute('value', 'x')
                    btn.setAttribute('delFile', file.name);
                    btn.setAttribute('style', chk_style);
                    btn.onclick = function (ev) {
                        var ele = ev.srcElement;
                        var delFile = ele.getAttribute('delFile');
                        for (var i = 0; i < sel_files.length; i++) {
                            if (delFile == sel_files[i].name) {
                                sel_files.splice(i, 1);
                            }
                        }

                        dt = new DataTransfer();
                        for (f in sel_files) {
                            var file = sel_files[f];
                            dt.items.add(file);
                        }
                        btnAtt.files = dt.files;
                        var p = ele.parentNode;
                        attZone.removeChild(p)
                    }
                    div.appendChild(img)
                    div.appendChild(btn)
                    return div
                }
            }
        )('att_zone', 'btnAtt')

        //시간계산 함수
        function elapsedText(date) {
            console.log(date);
            date = new Date(date);
            // 초 (밀리초)
            const seconds = 1;
            // 분
            const minute = seconds * 60;
            // 시
            const hour = minute * 60;
            // 일
            const day = hour * 24;

            var today = new Date();
            var elapsedTime = Math.trunc((today.getTime() - date.getTime()) / 1000);

            var elapsedText = "";
            if (elapsedTime < seconds) {
                elapsedText = "방금 전";
            } else if (elapsedTime < minute) {
                elapsedText = elapsedTime + "초 전";
            } else if (elapsedTime < hour) {
                elapsedText = Math.trunc(elapsedTime / minute) + "분 전";
            } else if (elapsedTime < day) {
                elapsedText = Math.trunc(elapsedTime / hour) + "시간 전";
            } else if (elapsedTime < (day * 3)) {
                elapsedText = Math.trunc(elapsedTime / day) + "일 전";
            } else {
                elapsedText = SimpleDateTimeFormat(date, "yyyy-MM-dd");
            }

            return elapsedText;
        }
        
      //검색
        function search(target){
         // elementary, middle, high
           var checkWord = $("#schoolInput").val();
           var schoolList = $("#schoolList");
           if(checkWord==""){
               schoolList.empty();
               return;
            }
           $.ajax({
               type: 'GET',
               dataType: 'JSON',
               url: '/own/sns/ListSearch', 
               error: function(err){
                   console.log(err);
               },
               success: function(data){
                  
                    console.log(checkWord);

                    schoolList.empty();
                    console.log(data);
                    data.forEach((school)=>{
                        if(school['snsNickname'].includes(checkWord)){
                            schoolList.append(`<img class="searchProfileImg" src="/imgView/${school['mediaServerFile']}" onerror='this.src="/css/sns/img/defaultUser.png"'>
                                           <span style="cursor: pointer;" onclick="select(this);"> ${school['snsNickname']} </span> <br/>
                                           `   );                
                        }
                    })
                   
               }
           })
       }    
            function select(target){
                location.href = '/own/snsFeed?snsNickname='+target.innerText
            }

    </script>



</body>
</div>
</html>