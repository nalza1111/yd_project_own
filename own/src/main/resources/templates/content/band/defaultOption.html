<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/band_layout}"
      lang="ko">
    <head>
   <link rel="icon" href="/css/band/gachi/own.png" type="image/png">
   <title>오늘의운동 가치</title> 	
   <style>
   /* 나이스셀렉트 */
	.list li {
		width: 200px;
	}
	.list {
		max-height: 200px;
				overflow-y: scroll !important;
	}
	.nice-select {
		width: 220px;
	}
	.btn:hover {
		color: #fff;
	}
	
    .btn:hover {
		color: #fff;
	}
	
	.input-text:focus {
		box-shadow: 0px 0px 0px;
		border-color: #f8c146;
		outline: 0px;
	}
	
	.form-control {
		border: 1px solid #f8c146;
	}
	
	.inputImage {
		border-radius: 10px;
		width: 100%;
	    height: 100%;
	    object-fit: cover;
	    border-radius: 20%;
	}
	
	.inputImage:hover {
		border: #BFBFBF 2px solid;
		cursor: pointer;
	}
	
	.bandBox {
	    width: 150px;
	    height: 150px; 
	    border-radius: 30%;
	    overflow: hidden;
	    border: 3px solid white;
	}   
		/* 셀렉트박스 */
       		@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap');

			select {
			  -moz-appearance: none;
			  -webkit-appearance: none;
			  appearance: none;
			  
			  font-family: "Noto Sansf KR", sans-serif;
			  font-size: 1rem;
			  font-weight: 400;
			  line-height: 1.5;
			  
			  color: #444;
			  background-color: #fff;
			  
			  padding: .6em 1.4em .5em .8em;
			  margin: 0;
			  
			  border: 1px solid #aaa;
			  border-radius: .5em;
			  box-shadow: 0 1px 0 1px rgba(0,0,0,.04);
			}
			
			select:hover {
			  border-color: #888;
			}
			
			select:focus {
			  border-color: #aaa;
			  box-shadow: 0 0 1px 3px rgba(59, 153, 252, .7);
			  box-shadow: 0 0 0 3px -moz-mac-focusring;
			  color: #222;
			  outline: none;
			}
			
			select:disabled {
			  opacity: 0.5;
			}
			select {
			  -moz-appearance: none;
			  -webkit-appearance: none;
			  appearance: none;
			}
			label {
				  font-family: "Noto Sans KR", sans-serif;
				  font-size: 1rem;
				  font-weight: 600;
				  line-height: 1.3;
				  
				  color: white;
				  
				  margin-right: 0.5em;
				}
       		/* 셀렉트박스 */
        </style>
    </head>
    <body>
   	<div layout:fragment="content">
 <!--================ 가치 추천 Area  =================-->
        <section class="facilities_area section_gap">
            <div class="overlay bg-parallax" style="opacity: 1" data-stellar-ratio="0.8" data-stellar-vertical-offset="0" data-background="">
            </div>
            <div class="container" style="background-color:rgba(0, 0, 0, 0.5); width: 1110px; padding: 50px 15px; border-radius: 30px;">
                <div class="section_title text-center" style=" margin: 50px 0px">
                    <h2 class="title_w">가치하기</h2>
                    <p style="visibility: hidden;">Who are in extremely love with eco friendly system.</p>
                    <div class="hotel_booking_area position" >
	                    <div class="container" style="padding-left: 190px;">
							<!--================폼 시작 Area =================-->      
				         	<form role="form" action="/own/band/insertDefault" method="post" autocomplete="off" style="width: 80%;"enctype="multipart/form-data">
				         		<input type="hidden" th:name="${_csrf.parameterName}"th:value="${_csrf.token}">
				         		<input type="hidden" th:value="${session.userId}" name="userId" id="userId"/>
				         		<div class="imgArea" style="display: flex; flex-direction: column;">
				<!--================이미지 Area =================-->
									<div>
										<div style="flex-grow: 3; display: flex; justify-content: space-between; position: relative; width: 750px;" class="imgss">
											<div style="flex-grow: 1; width: 150px; height: 150px;" class="bandBox">
			                					<img th:src="|/imgView/bandprofilnull.png|" id="inputImage" name="inputImage" alt="" style="flex-grow: 1;">
			                				</div>
			                				<p><i class="fa-regular fa-images fa-2x" style="border-radius:20px; position: absolute; bottom:10px; left: 130px;"></i></p>
				<!--================ 이름 =================-->
												<div style="display: inline-block; width: 70%; padding: 10px 0px 0px 50px; flex-grow: 3; display: flex; flex-direction: column;">
													<h6 class="typo-list" style="float: left; padding-left: 10px; color:white; padding: 0px 380px 0px 0px;">
														가치 활동명</h6>
													<div class="mt-10">
														<input type="text"
															id="bandNickname" name="bandNickname" maxlength="10"
															placeholder="가치 활동명 입력" onfocus="this.placeholder = ''"
															onblur="this.placeholder = '가치 활동명'" required
															class="single-input"
															style="height: 50px; font-size: 20px; width: 88%; display: block; float: left; border-radius: 10px">
													</div>
													<b><small
														style="display: inline; width: 10%; float: right"
														id="nickNamelength">4/10</small></b>
													<div id="hiddenBox" style="display: none">
														<b style="padding-left: 10px;" id="hiddenBoxText">가입가능한
															닉네임입니다</b>
													</div>
												</div>
												<!--================ 이름 끝 =================-->
							                </div>
							            </div>
		<!--================이미지 Area 끝 =================-->
								</div><!-- 이미지끝남 -->
								<div class="insertArea"
									style="margin: 0px auto; padding:30px 350px 0px 50px; width: 1080px; display: flex; justify-content: flex-end;">
									<!--================ 셀렉트박스  =================-->
										<div class="col-md-5" style="padding-right: 0px;">
											<div class="">
											<label for="exe" style="line-height: 48px;"> 운동 </label>
												<select class="exercise" id="exe" style="width: 155px; height: 50px;"
													th:value="*{exercise}" name="bandInterest" slot="">
													<option value="">전체</option>
													<option th:each="exe : ${exercise}"
														th:value="${exe.exersubNo}" th:text="${exe.exersubName}"></option>
												</select>
											</div>
										</div>
										<div class="col-md-5" style="padding-right: 0px;">
											<div class="">
											<label for="lo" style="line-height: 48px;"> 지역 </label>
												<select class="location" id="lo" style="width: 155px; height: 50px;"
													th:value="*{location}" name="bandLocation">
													<option value="">전체</option>
													<option th:each="loc : ${location}" 
														th:value="${loc.locCode}" th:text="${loc.locCity}"></option>
												</select>
											</div>
										</div>
									<!--================ 셀렉트박스  =================-->
								</div>
								<input type="file" id="deImg" multiple="multiple" name="deImg" style="display: none" onchange="imgFnc()" accept="image/gif, image/jpeg, image/png">
								<button type="submit" id="submitBtn" class="genric-btn primary circle arrow"
									style="font-size: 20px; margin-top: 80px; width: 500px; padding-left: 230px;">생성</button>
							</form>	
						</div>
            		</div>
                </div>
            </div>
        </section>
        <!--================ 밴드생성 끝 Area  =================-->
        
        <!-- Optional JavaScript -->
        <script>
        // 특수문자 정규식 변수(공백 미포함)
        var replaceChar = /[~!@\#$%^&*\()\-=+_'\;<>\/.\`:\"\\,\[\]?|{}]/gi;
 		// 완성형 아닌 한글 정규식		
        var replaceNotFullKorean = /[ㄱ-ㅎㅏ-ㅣ]/gi;
        $(function(){
            //별명 중복체크...
            $('#bandNickname').on('change', function(){
            	let nickName = $('#bandNickname').val();
    			if(nickName == '') {
    				$('#hiddenBoxText').text('닉네임을 입력해주세요.');
    				$('#hiddenBox').show();
    			} else if(nickName.match(replaceChar)||nickName.match(replaceNotFullKorean)){
    				$('#hiddenBoxText').text('특수문자를 제외하고 올바른 문자를 입력해주십시오.');
    				$('#hiddenBox').show();
    			} else {
    				$('#hiddenBoxText').text('사용가능한 닉네임입니다.');
    				$('#hiddenBox').show();
    			}
            })
            //닉네임 공백막기 글자수
             $('#bandNickname').keyup(function(e){
            	//닉네임 공백막기
            	 if($(this).val().search(/\s/) != -1){ //공백이 있나 체크 후
           			$(this).val( $(this).val().replace(/ /gi, '') );
           			$('#hiddenBox').show();
           			$('#hiddenBoxText').text('공백입력은 불가능합니다.');
            	 }
            	//글자수 체크
            	 chkNickLength();
            })
          //닉네임 글자수 체크  
        	function chkNickLength(){
        		$('#nickNamelength').text($('#bandNickname').val().length+'/10');
        	}
          	//인트로  글자수
            $('#bandMemberIntro').keyup(function(e){
           	//글자수 체크
           	 chkIntroLength();
           })
            //글자수체크
            chkNickLength();
        })
        //이미지삽임
            $('.imgss').on('click', '#inputImage', function(){
            	$('#deImg').click();
            })
            //이미지첨부 눌렀을 때
            function imgFnc(){
            	//파일
            	let imgFile = $('#deImg').val();
            	//확장자제한
            	let fileForm = /(.*?)\.(jpg|jpeg|png)$/;
            	//50mb로 제한
            	let maxSize = 100 * 1024 * 1024;
            	//특수문자 제한
            	let pattern =  /[\{\}\/?,;:|*~`!^\+<>@\#$%&\\\=\'\"]/gi;
            	//파일크기제한
            	let fileSize;
    			
            	if($('#deImg').val() == "") {
            		alert("첨부파일은 필수!");
            	    return;
            	}
            	//파일명과 사이즈를 뽑기위한..제이쿼리를 모르겠음 이건
            	let fileName = document.getElementById("deImg").files[0]
            	//파일이 비었다면
            	if(imgFile != "" && imgFile != null) {
            		//input=file의 files 속성가져와서...
            		fileSize = fileName.size;
            	    if(!imgFile.match(fileForm)) {
            	    	alert("이미지 파일만 업로드 가능");
            	        return;
            	    } else if(fileSize > maxSize) {
            	    	alert("파일 사이즈는 100MB까지 가능");
            	        return;
            	    } else if(pattern.test(fileName.name)){
            	    	alert("파일 이름 특수문자 nono");
            	        return;
            	    }
            	}
            }
            //이미지 업로드 시 미리보기createImage
            $('#deImg').on('change', function(e){
            	let file = e.target.files[0];
            	let reader = new FileReader();
            	reader.onload = function(e){
            		$('#inputImage').attr('src', e.target.result);
            		//기존이미지 누를시..
            		$('input[name=mediaServerFile]').val('sample')
            	}
            	reader.readAsDataURL(file);
            	
            })
            $(document).ready(function() {
				$('select').niceSelect();
			})
        </script>
    	</div>
	</body>
</html>